<div *ngIf="flowError$ | async" class="error">
  An error was encountered.
  <div *ngIf="resultsStderr$ | async as resultsStderr">
    stderr is: {{resultsStderr}}
  </div>
</div>

<div *ngIf="flowRunning$ | async" class="in-progress">
  <div>Query in progress: {{ (args$ | async).query }}</div>
  <div *ngIf="(args$ | async)?.fileCollectColumns as fileCollectColumns">
    <span>Columns for file collection:</span>
    <span>{{fileCollectColumns || json}}</span>
  </div>
</div>

<ng-container *ngIf="flowCompleted$ | async">
  <div
    *ngIf="numberOfRowsAvailable$ | async"
    class="flow-details-summary-actions export-button-holder">
    <ng-container *ngIf="(args$ | async)?.fileCollectColumns as fileCollectColumns">
      <a
        *ngIf="collectedFilesLink$ | async as collectedFilesLink"
        [href]="collectedFilesLink"
        download
        mat-stroked-button color="primary">
        Downlod collected files
      </a>
    </ng-container>

    <a
      *ngIf="exportCsvLink$ | async as exportCsvLink"
      [href]="exportCsvLink"
      download
      mat-stroked-button color="primary">
      Download results as CSV
    </a>
  </div>

  <div *ngIf="(args$ | async)?.fileCollectColumns as fileCollectColumns">
    <span>File collected columns:</span>
    <span>{{fileCollectColumns || json}}</span>
  </div>

  <osquery-results-table
    *ngIf="displayTable$ | async as displayTable"
    [table]="displayTable">
  </osquery-results-table>

  <div
    *ngIf="additionalRowsAvailable$ | async as additionalCount"
    class="show-additional">
    <button (click)="loadCompleteResults()">View all rows ({{additionalCount}} more)</button>
  </div>
</ng-container>
